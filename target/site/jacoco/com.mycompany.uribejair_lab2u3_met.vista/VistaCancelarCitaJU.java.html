<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>VistaCancelarCitaJU.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">UribeJair_Lab2U3_Met</a> &gt; <a href="index.source.html" class="el_package">com.mycompany.uribejair_lab2u3_met.vista</a> &gt; <span class="el_source">VistaCancelarCitaJU.java</span></div><h1>VistaCancelarCitaJU.java</h1><pre class="source lang-java linenums">/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package com.mycompany.uribejair_lab2u3_met.vista;

import com.mycompany.uribejair_lab2u3_met.controlador.ControladorCancelarCita;
import com.mycompany.uribejair_lab2u3_met.modelo.Cita;
import javax.swing.*;
import javax.swing.border.*;
import javax.swing.table.*;
import java.awt.*;
import java.time.format.DateTimeFormatter;
import java.util.List;

/**
 * VISTA GESTIONAR CITAS
 * Interfaz redise√±ada para cancelar y eliminar citas
 */
public class VistaCancelarCitaJU extends JFrame {

    private ControladorCancelarCita controlador;
    private JTable tablaCitas;
    private DefaultTableModel modeloTabla;

    private JButton btnCancelar, btnActualizar, btnEliminar, btnVolver;

<span class="fc" id="L28">    private DateTimeFormatter formatter = DateTimeFormatter.ofPattern(&quot;dd/MM/yyyy HH:mm&quot;);</span>

    // ================== PALETA OSCURA ==================
<span class="fc" id="L31">    private final Color COLOR_PRIMARIO = new Color(30, 30, 30);</span>
<span class="fc" id="L32">    private final Color COLOR_SECUNDARIO = new Color(20, 33, 61);</span>
<span class="fc" id="L33">    private final Color COLOR_ACENTO = new Color(0, 121, 107);</span>
<span class="fc" id="L34">    private final Color COLOR_PELIGRO = new Color(176, 32, 32);</span>
<span class="fc" id="L35">    private final Color COLOR_GRIS = new Color(69, 90, 100);</span>
<span class="fc" id="L36">    private final Color FONDO_GENERAL = new Color(240, 240, 240);</span>
<span class="fc" id="L37">    private final Color BLANCO = Color.WHITE;</span>

<span class="fc" id="L39">    public VistaCancelarCitaJU() {</span>
<span class="fc" id="L40">        configurarVentana();</span>
<span class="fc" id="L41">        inicializarComponentes();</span>
<span class="fc" id="L42">    }</span>

    private void configurarVentana() {
<span class="fc" id="L45">        setTitle(&quot;Sistema de Gesti√≥n de Citas | Gesti√≥n&quot;);</span>
<span class="fc" id="L46">        setSize(1050, 720);</span>
<span class="fc" id="L47">        setDefaultCloseOperation(DISPOSE_ON_CLOSE);</span>
<span class="fc" id="L48">        setLocationRelativeTo(null);</span>
<span class="fc" id="L49">        setLayout(new BorderLayout(15, 15));</span>
<span class="fc" id="L50">        getContentPane().setBackground(FONDO_GENERAL);</span>
<span class="fc" id="L51">    }</span>

    private void inicializarComponentes() {
<span class="fc" id="L54">        add(crearPanelTitulo(), BorderLayout.NORTH);</span>
<span class="fc" id="L55">        add(crearPanelTabla(), BorderLayout.CENTER);</span>
<span class="fc" id="L56">        add(crearPanelBotones(), BorderLayout.SOUTH);</span>
<span class="fc" id="L57">    }</span>

    // ================== TITULO ==================
    private JPanel crearPanelTitulo() {
<span class="fc" id="L61">        JPanel panel = new JPanel();</span>
<span class="fc" id="L62">        panel.setBackground(COLOR_SECUNDARIO);</span>
<span class="fc" id="L63">        panel.setBorder(new EmptyBorder(25, 30, 25, 30));</span>
<span class="fc" id="L64">        panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));</span>

<span class="fc" id="L66">        JLabel titulo = new JLabel(&quot;GESTI√ìN DE CITAS AGENDADAS&quot;);</span>
<span class="fc" id="L67">        titulo.setFont(new Font(&quot;Segoe UI&quot;, Font.BOLD, 30));</span>
<span class="fc" id="L68">        titulo.setForeground(Color.WHITE);</span>
<span class="fc" id="L69">        titulo.setAlignmentX(Component.LEFT_ALIGNMENT);</span>

<span class="fc" id="L71">        JLabel sub = new JLabel(&quot;Visualice, cancele o elimine citas registradas&quot;);</span>
<span class="fc" id="L72">        sub.setFont(new Font(&quot;Segoe UI&quot;, Font.PLAIN, 14));</span>
<span class="fc" id="L73">        sub.setForeground(new Color(210, 210, 210));</span>
<span class="fc" id="L74">        sub.setAlignmentX(Component.LEFT_ALIGNMENT);</span>

<span class="fc" id="L76">        panel.add(titulo);</span>
<span class="fc" id="L77">        panel.add(Box.createVerticalStrut(6));</span>
<span class="fc" id="L78">        panel.add(sub);</span>

<span class="fc" id="L80">        return panel;</span>
    }

    // ================== TABLA ==================
    private JPanel crearPanelTabla() {
<span class="fc" id="L85">        JPanel panel = new JPanel(new BorderLayout());</span>
<span class="fc" id="L86">        panel.setBorder(new EmptyBorder(20, 25, 20, 25));</span>
<span class="fc" id="L87">        panel.setBackground(FONDO_GENERAL);</span>

<span class="fc" id="L89">        JPanel contenedor = new JPanel(new BorderLayout());</span>
<span class="fc" id="L90">        contenedor.setBackground(BLANCO);</span>
<span class="fc" id="L91">        contenedor.setBorder(BorderFactory.createCompoundBorder(</span>
                new LineBorder(COLOR_PRIMARIO, 2, true),
                new EmptyBorder(15, 15, 15, 15)
        ));

<span class="fc" id="L96">        String[] columnas = {</span>
                &quot;ID&quot;, &quot;Nombre&quot;, &quot;Correo Electr√≥nico&quot;,
                &quot;Tel√©fono&quot;, &quot;Fecha y Hora&quot;, &quot;Estado&quot;
        };

<span class="fc" id="L101">        modeloTabla = new DefaultTableModel(columnas, 0) {</span>
            public boolean isCellEditable(int r, int c) {
<span class="nc" id="L103">                return false;</span>
            }
        };

<span class="fc" id="L107">        tablaCitas = new JTable(modeloTabla);</span>
<span class="fc" id="L108">        tablaCitas.setRowHeight(40);</span>
<span class="fc" id="L109">        tablaCitas.setFont(new Font(&quot;Segoe UI&quot;, Font.PLAIN, 14));</span>
<span class="fc" id="L110">        tablaCitas.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);</span>
<span class="fc" id="L111">        tablaCitas.setSelectionBackground(new Color(200, 230, 225));</span>
<span class="fc" id="L112">        tablaCitas.setSelectionForeground(COLOR_PRIMARIO);</span>
<span class="fc" id="L113">        tablaCitas.setGridColor(new Color(200, 200, 200));</span>
<span class="fc" id="L114">        tablaCitas.setShowVerticalLines(false);</span>

        // ===== HEADER (CORREGIDO DEFINITIVO) =====
<span class="fc" id="L117">        JTableHeader header = tablaCitas.getTableHeader();</span>
<span class="fc" id="L118">        header.setPreferredSize(new Dimension(header.getWidth(), 42));</span>
<span class="fc" id="L119">        header.setReorderingAllowed(false);</span>

<span class="fc" id="L121">        DefaultTableCellRenderer headerRenderer = new DefaultTableCellRenderer();</span>
<span class="fc" id="L122">        headerRenderer.setBackground(new Color(220, 220, 220)); // gris claro</span>
<span class="fc" id="L123">        headerRenderer.setForeground(Color.BLACK);              // üî• LETRAS NEGRAS</span>
<span class="fc" id="L124">        headerRenderer.setHorizontalAlignment(SwingConstants.CENTER);</span>
<span class="fc" id="L125">        headerRenderer.setFont(new Font(&quot;Segoe UI&quot;, Font.BOLD, 14));</span>

<span class="fc bfc" id="L127" title="All 2 branches covered.">        for (int i = 0; i &lt; tablaCitas.getColumnModel().getColumnCount(); i++) {</span>
<span class="fc" id="L128">            tablaCitas.getColumnModel().getColumn(i).setHeaderRenderer(headerRenderer);</span>
        }

        // ===== RENDER GENERAL =====
<span class="fc" id="L132">        DefaultTableCellRenderer general = new DefaultTableCellRenderer() {</span>
            public Component getTableCellRendererComponent(
                    JTable table, Object value, boolean selected,
                    boolean focus, int row, int col) {

<span class="nc" id="L137">                Component c = super.getTableCellRendererComponent(</span>
                        table, value, selected, focus, row, col);

<span class="nc bnc" id="L140" title="All 2 branches missed.">                if (!selected) {</span>
<span class="nc bnc" id="L141" title="All 2 branches missed.">                    c.setBackground(row % 2 == 0 ? BLANCO : new Color(245, 245, 245));</span>
<span class="nc" id="L142">                    c.setForeground(COLOR_PRIMARIO);</span>
                }
<span class="nc" id="L144">                setHorizontalAlignment(SwingConstants.CENTER);</span>
<span class="nc" id="L145">                return c;</span>
            }
        };

<span class="fc bfc" id="L149" title="All 2 branches covered.">        for (int i = 0; i &lt; 5; i++) {</span>
<span class="fc" id="L150">            tablaCitas.getColumnModel().getColumn(i).setCellRenderer(general);</span>
        }

        // ===== RENDER ESTADO =====
<span class="fc" id="L154">        tablaCitas.getColumnModel().getColumn(5).setCellRenderer(</span>
<span class="fc" id="L155">                new DefaultTableCellRenderer() {</span>
                    public Component getTableCellRendererComponent(
                            JTable table, Object value, boolean selected,
                            boolean focus, int row, int col) {

<span class="nc" id="L160">                        Component c = super.getTableCellRendererComponent(</span>
                                table, value, selected, focus, row, col);

<span class="nc" id="L163">                        setHorizontalAlignment(SwingConstants.CENTER);</span>
<span class="nc" id="L164">                        setFont(new Font(&quot;Segoe UI&quot;, Font.BOLD, 13));</span>

<span class="nc bnc" id="L166" title="All 2 branches missed.">                        if (!selected) {</span>
<span class="nc bnc" id="L167" title="All 2 branches missed.">                            c.setBackground(row % 2 == 0 ? BLANCO : new Color(245, 245, 245));</span>
<span class="nc bnc" id="L168" title="All 2 branches missed.">                            if (&quot;Confirmada&quot;.equalsIgnoreCase(value.toString())) {</span>
<span class="nc" id="L169">                                c.setForeground(COLOR_ACENTO);</span>
                            } else {
<span class="nc" id="L171">                                c.setForeground(COLOR_PELIGRO);</span>
                            }
                        }
<span class="nc" id="L174">                        return c;</span>
                    }
                });

        // ===== ANCHOS =====
<span class="fc" id="L179">        tablaCitas.getColumnModel().getColumn(0).setPreferredWidth(60);</span>
<span class="fc" id="L180">        tablaCitas.getColumnModel().getColumn(1).setPreferredWidth(180);</span>
<span class="fc" id="L181">        tablaCitas.getColumnModel().getColumn(2).setPreferredWidth(240);</span>
<span class="fc" id="L182">        tablaCitas.getColumnModel().getColumn(3).setPreferredWidth(120);</span>
<span class="fc" id="L183">        tablaCitas.getColumnModel().getColumn(4).setPreferredWidth(180);</span>
<span class="fc" id="L184">        tablaCitas.getColumnModel().getColumn(5).setPreferredWidth(110);</span>

<span class="fc" id="L186">        JScrollPane scroll = new JScrollPane(tablaCitas);</span>
<span class="fc" id="L187">        scroll.setBorder(new LineBorder(COLOR_PRIMARIO, 1));</span>
<span class="fc" id="L188">        scroll.getViewport().setBackground(BLANCO);</span>

<span class="fc" id="L190">        contenedor.add(scroll, BorderLayout.CENTER);</span>
<span class="fc" id="L191">        panel.add(contenedor, BorderLayout.CENTER);</span>

<span class="fc" id="L193">        return panel;</span>
    }

    // ================== BOTONES ==================
    private JPanel crearPanelBotones() {
<span class="fc" id="L198">        JPanel panel = new JPanel(new FlowLayout(FlowLayout.CENTER, 15, 18));</span>
<span class="fc" id="L199">        panel.setBackground(FONDO_GENERAL);</span>

<span class="fc" id="L201">        btnVolver = crearBoton(&quot;Volver&quot;, COLOR_GRIS);</span>
<span class="fc" id="L202">        btnActualizar = crearBoton(&quot;Actualizar&quot;, COLOR_SECUNDARIO);</span>
<span class="fc" id="L203">        btnCancelar = crearBoton(&quot;Cancelar Cita&quot;, COLOR_PELIGRO);</span>
<span class="fc" id="L204">        btnEliminar = crearBoton(&quot;Eliminar Cita&quot;, new Color(120, 120, 120));</span>

<span class="pc" id="L206">        btnVolver.addActionListener(e -&gt; dispose());</span>
<span class="pc" id="L207">        btnActualizar.addActionListener(e -&gt; controlador.actualizarListaCitas());</span>
<span class="pc" id="L208">        btnCancelar.addActionListener(e -&gt; cancelarCitaSeleccionada());</span>
<span class="pc" id="L209">        btnEliminar.addActionListener(e -&gt; eliminarCitaSeleccionada());</span>

<span class="fc" id="L211">        panel.add(btnVolver);</span>
<span class="fc" id="L212">        panel.add(btnActualizar);</span>
<span class="fc" id="L213">        panel.add(btnCancelar);</span>
<span class="fc" id="L214">        panel.add(btnEliminar);</span>

<span class="fc" id="L216">        return panel;</span>
    }

    private JButton crearBoton(String texto, Color color) {
<span class="fc" id="L220">        JButton btn = new JButton(texto);</span>
<span class="fc" id="L221">        btn.setBackground(color);</span>
<span class="fc" id="L222">        btn.setForeground(Color.WHITE);</span>
<span class="fc" id="L223">        btn.setFont(new Font(&quot;Segoe UI&quot;, Font.BOLD, 14));</span>
<span class="fc" id="L224">        btn.setPreferredSize(new Dimension(200, 46));</span>
<span class="fc" id="L225">        btn.setBorderPainted(false);</span>
<span class="fc" id="L226">        btn.setFocusPainted(false);</span>
<span class="fc" id="L227">        btn.setCursor(new Cursor(Cursor.HAND_CURSOR));</span>

<span class="fc" id="L229">        btn.addMouseListener(new java.awt.event.MouseAdapter() {</span>
            public void mouseEntered(java.awt.event.MouseEvent e) {
<span class="nc" id="L231">                btn.setBackground(color.darker());</span>
<span class="nc" id="L232">            }</span>
            public void mouseExited(java.awt.event.MouseEvent e) {
<span class="nc" id="L234">                btn.setBackground(color);</span>
<span class="nc" id="L235">            }</span>
        });
<span class="fc" id="L237">        return btn;</span>
    }

    // ================== LOGICA ==================
    private void cancelarCitaSeleccionada() {
<span class="nc" id="L242">        int fila = tablaCitas.getSelectedRow();</span>
<span class="nc bnc" id="L243" title="All 2 branches missed.">        if (fila == -1) {</span>
<span class="nc" id="L244">            mostrarError(&quot;Seleccione una cita&quot;);</span>
<span class="nc" id="L245">            return;</span>
        }
<span class="nc" id="L247">        int id = Integer.parseInt(modeloTabla.getValueAt(fila, 0).toString());</span>
<span class="nc" id="L248">        controlador.cancelarCita(id);</span>
<span class="nc" id="L249">    }</span>

    private void eliminarCitaSeleccionada() {
<span class="nc" id="L252">        int fila = tablaCitas.getSelectedRow();</span>
<span class="nc bnc" id="L253" title="All 2 branches missed.">        if (fila == -1) {</span>
<span class="nc" id="L254">            mostrarError(&quot;Seleccione una cita&quot;);</span>
<span class="nc" id="L255">            return;</span>
        }
<span class="nc" id="L257">        int id = Integer.parseInt(modeloTabla.getValueAt(fila, 0).toString());</span>
<span class="nc" id="L258">        controlador.eliminarCita(id);</span>
<span class="nc" id="L259">    }</span>

    // ================== METODOS PUBLICOS ==================
    public void setControlador(ControladorCancelarCita c) {
<span class="fc" id="L263">        controlador = c;</span>
<span class="fc" id="L264">    }</span>

    public void actualizarTabla(List&lt;Cita&gt; citas) {
<span class="fc" id="L267">        modeloTabla.setRowCount(0);</span>
<span class="fc bfc" id="L268" title="All 2 branches covered.">        for (Cita c : citas) {</span>
<span class="fc" id="L269">            modeloTabla.addRow(new Object[]{</span>
<span class="fc" id="L270">                    c.getId(),</span>
<span class="fc" id="L271">                    c.getNombreUsuario(),</span>
<span class="fc" id="L272">                    c.getEmail(),</span>
<span class="fc" id="L273">                    c.getTelefono(),</span>
<span class="fc" id="L274">                    c.getFechaHora().format(formatter),</span>
<span class="fc" id="L275">                    c.getEstado()</span>
            });
<span class="fc" id="L277">        }</span>
<span class="fc" id="L278">    }</span>

    public void mostrarExito(String mensaje) {
<span class="nc" id="L281">        JOptionPane.showMessageDialog(this, mensaje, &quot;Operacion Exitosa&quot;,</span>
                JOptionPane.INFORMATION_MESSAGE);
<span class="nc" id="L283">    }</span>

    public void mostrarError(String mensaje) {
<span class="nc" id="L286">        JOptionPane.showMessageDialog(this, mensaje, &quot;Error&quot;,</span>
                JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L288">    }</span>

    public void mostrarMensaje(String mensaje) {
<span class="nc" id="L291">        JOptionPane.showMessageDialog(this, mensaje, &quot;Informacion&quot;,</span>
                JOptionPane.INFORMATION_MESSAGE);
<span class="nc" id="L293">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>