<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>VistaGestionHorarios.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">UribeJair_Lab2U3_Met</a> &gt; <a href="index.source.html" class="el_package">com.mycompany.uribejair_lab2u3_met.vista</a> &gt; <span class="el_source">VistaGestionHorarios.java</span></div><h1>VistaGestionHorarios.java</h1><pre class="source lang-java linenums">/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package com.mycompany.uribejair_lab2u3_met.vista;

import com.mycompany.uribejair_lab2u3_met.controlador.ControladorHorarios;
import com.mycompany.uribejair_lab2u3_met.modelo.ConfiguracionHorario;
import javax.swing.*;
import javax.swing.border.*;
import java.awt.*;
import java.time.LocalTime;

/**
 * VISTA GESTION DE HORARIOS
 * Interfaz rediseñada para configurar horarios de atencion
 */
public class VistaGestionHorarios extends JFrame {
    
    private ControladorHorarios controlador;
    private JComboBox&lt;String&gt; comboDias;
    private JSpinner spinnerHoraInicio;
    private JSpinner spinnerHoraFin;
    private JSpinner spinnerDuracion;
    private JSpinner spinnerDescanso;
    private JCheckBox checkActivo;
    private JLabel lblCapacidad;
    private JButton btnGuardar, btnCargar, btnVolver, btnRestaurar;
    
<span class="fc" id="L30">    private String[] dias = {&quot;Lunes&quot;, &quot;Martes&quot;, &quot;Miercoles&quot;, &quot;Jueves&quot;, &quot;Viernes&quot;, &quot;Sabado&quot;, &quot;Domingo&quot;};</span>
    
    // Paleta de colores
<span class="fc" id="L33">    private final Color COLOR_PRIMARIO = new Color(44, 62, 80);</span>
<span class="fc" id="L34">    private final Color COLOR_SECUNDARIO = new Color(52, 152, 219);</span>
<span class="fc" id="L35">    private final Color COLOR_ACENTO = new Color(39, 174, 96);</span>
<span class="fc" id="L36">    private final Color COLOR_INFO = new Color(142, 68, 173);</span>
<span class="fc" id="L37">    private final Color COLOR_ADVERTENCIA = new Color(231, 76, 60);</span>
<span class="fc" id="L38">    private final Color COLOR_OSCURO = new Color(52, 73, 94);</span>
<span class="fc" id="L39">    private final Color FONDO_CLARO = new Color(236, 240, 241);</span>
<span class="fc" id="L40">    private final Color FONDO_BLANCO = new Color(255, 255, 255);</span>
    
<span class="fc" id="L42">    public VistaGestionHorarios() {</span>
<span class="fc" id="L43">        configurarVentana();</span>
<span class="fc" id="L44">        inicializarComponentes();</span>
<span class="fc" id="L45">    }</span>
    
    private void configurarVentana() {
<span class="fc" id="L48">        setTitle(&quot;Sistema de Gestion de Citas - Configuracion de Horarios&quot;);</span>
<span class="fc" id="L49">        setSize(800, 750);</span>
<span class="fc" id="L50">        setDefaultCloseOperation(DISPOSE_ON_CLOSE);</span>
<span class="fc" id="L51">        setLocationRelativeTo(null);</span>
<span class="fc" id="L52">        setLayout(new BorderLayout(15, 15));</span>
<span class="fc" id="L53">        getContentPane().setBackground(FONDO_CLARO);</span>
<span class="fc" id="L54">    }</span>
    
    private void inicializarComponentes() {
<span class="fc" id="L57">        add(crearPanelTitulo(), BorderLayout.NORTH);</span>
<span class="fc" id="L58">        add(crearPanelFormulario(), BorderLayout.CENTER);</span>
<span class="fc" id="L59">        add(crearPanelBotones(), BorderLayout.SOUTH);</span>
<span class="fc" id="L60">    }</span>
    
    private JPanel crearPanelTitulo() {
<span class="fc" id="L63">        JPanel panel = new JPanel();</span>
<span class="fc" id="L64">        panel.setBackground(COLOR_INFO);</span>
<span class="fc" id="L65">        panel.setBorder(new EmptyBorder(30, 25, 30, 25));</span>
        
<span class="fc" id="L67">        JLabel lblTitulo = new JLabel(&quot;Configuracion de Horarios&quot;);</span>
<span class="fc" id="L68">        lblTitulo.setFont(new Font(&quot;Segoe UI&quot;, Font.BOLD, 32));</span>
<span class="fc" id="L69">        lblTitulo.setForeground(Color.WHITE);</span>
        
<span class="fc" id="L71">        JLabel lblSubtitulo = new JLabel(&quot;Configure los horarios de atencion por dia de la semana&quot;);</span>
<span class="fc" id="L72">        lblSubtitulo.setFont(new Font(&quot;Segoe UI&quot;, Font.PLAIN, 15));</span>
<span class="fc" id="L73">        lblSubtitulo.setForeground(new Color(236, 240, 241));</span>
        
<span class="fc" id="L75">        panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));</span>
<span class="fc" id="L76">        lblTitulo.setAlignmentX(Component.CENTER_ALIGNMENT);</span>
<span class="fc" id="L77">        lblSubtitulo.setAlignmentX(Component.CENTER_ALIGNMENT);</span>
        
<span class="fc" id="L79">        panel.add(lblTitulo);</span>
<span class="fc" id="L80">        panel.add(Box.createVerticalStrut(8));</span>
<span class="fc" id="L81">        panel.add(lblSubtitulo);</span>
        
<span class="fc" id="L83">        return panel;</span>
    }
    
    private JPanel crearPanelFormulario() {
<span class="fc" id="L87">        JPanel panel = new JPanel(new GridBagLayout());</span>
<span class="fc" id="L88">        panel.setBackground(FONDO_BLANCO);</span>
<span class="fc" id="L89">        panel.setBorder(BorderFactory.createCompoundBorder(</span>
            new EmptyBorder(25, 25, 25, 25),
<span class="fc" id="L91">            BorderFactory.createCompoundBorder(</span>
                new LineBorder(new Color(189, 195, 199), 2, true),
                new EmptyBorder(30, 30, 30, 30)
            )
        ));
        
<span class="fc" id="L97">        GridBagConstraints gbc = new GridBagConstraints();</span>
<span class="fc" id="L98">        gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="fc" id="L99">        gbc.insets = new Insets(15, 15, 15, 15);</span>
        
        // Dia de la semana
<span class="fc" id="L102">        gbc.gridx = 0; </span>
<span class="fc" id="L103">        gbc.gridy = 0;</span>
<span class="fc" id="L104">        gbc.anchor = GridBagConstraints.WEST;</span>
<span class="fc" id="L105">        panel.add(crearLabel(&quot;Dia de la Semana&quot;), gbc);</span>
        
<span class="fc" id="L107">        gbc.gridx = 1;</span>
<span class="fc" id="L108">        comboDias = new JComboBox&lt;&gt;(dias);</span>
<span class="fc" id="L109">        comboDias.setFont(new Font(&quot;Segoe UI&quot;, Font.PLAIN, 14));</span>
<span class="fc" id="L110">        comboDias.setPreferredSize(new Dimension(300, 40));</span>
<span class="fc" id="L111">        comboDias.setBackground(FONDO_BLANCO);</span>
<span class="fc" id="L112">        comboDias.setBorder(new LineBorder(new Color(189, 195, 199), 1, true));</span>
<span class="pc" id="L113">        comboDias.addActionListener(e -&gt; cargarConfiguracionActual());</span>
<span class="fc" id="L114">        panel.add(comboDias, gbc);</span>
        
        // Hora inicio
<span class="fc" id="L117">        gbc.gridx = 0; </span>
<span class="fc" id="L118">        gbc.gridy = 1;</span>
<span class="fc" id="L119">        panel.add(crearLabel(&quot;Hora de Inicio&quot;), gbc);</span>
        
<span class="fc" id="L121">        gbc.gridx = 1;</span>
<span class="fc" id="L122">        spinnerHoraInicio = new JSpinner(new SpinnerDateModel());</span>
<span class="fc" id="L123">        JSpinner.DateEditor editorInicio = new JSpinner.DateEditor(spinnerHoraInicio, &quot;HH:mm&quot;);</span>
<span class="fc" id="L124">        spinnerHoraInicio.setEditor(editorInicio);</span>
<span class="fc" id="L125">        spinnerHoraInicio.setFont(new Font(&quot;Segoe UI&quot;, Font.PLAIN, 14));</span>
<span class="fc" id="L126">        spinnerHoraInicio.setPreferredSize(new Dimension(300, 40));</span>
<span class="fc" id="L127">        spinnerHoraInicio.setBorder(new LineBorder(new Color(189, 195, 199), 1, true));</span>
<span class="fc" id="L128">        spinnerHoraInicio.addChangeListener(e -&gt; actualizarCapacidad());</span>
<span class="fc" id="L129">        panel.add(spinnerHoraInicio, gbc);</span>
        
        // Hora fin
<span class="fc" id="L132">        gbc.gridx = 0; </span>
<span class="fc" id="L133">        gbc.gridy = 2;</span>
<span class="fc" id="L134">        panel.add(crearLabel(&quot;Hora de Fin&quot;), gbc);</span>
        
<span class="fc" id="L136">        gbc.gridx = 1;</span>
<span class="fc" id="L137">        spinnerHoraFin = new JSpinner(new SpinnerDateModel());</span>
<span class="fc" id="L138">        JSpinner.DateEditor editorFin = new JSpinner.DateEditor(spinnerHoraFin, &quot;HH:mm&quot;);</span>
<span class="fc" id="L139">        spinnerHoraFin.setEditor(editorFin);</span>
<span class="fc" id="L140">        spinnerHoraFin.setFont(new Font(&quot;Segoe UI&quot;, Font.PLAIN, 14));</span>
<span class="fc" id="L141">        spinnerHoraFin.setPreferredSize(new Dimension(300, 40));</span>
<span class="fc" id="L142">        spinnerHoraFin.setBorder(new LineBorder(new Color(189, 195, 199), 1, true));</span>
<span class="fc" id="L143">        spinnerHoraFin.addChangeListener(e -&gt; actualizarCapacidad());</span>
<span class="fc" id="L144">        panel.add(spinnerHoraFin, gbc);</span>
        
        // Duracion de cita
<span class="fc" id="L147">        gbc.gridx = 0; </span>
<span class="fc" id="L148">        gbc.gridy = 3;</span>
<span class="fc" id="L149">        panel.add(crearLabel(&quot;Duracion por Cita (minutos)&quot;), gbc);</span>
        
<span class="fc" id="L151">        gbc.gridx = 1;</span>
<span class="fc" id="L152">        spinnerDuracion = new JSpinner(new SpinnerNumberModel(30, 15, 120, 15));</span>
<span class="fc" id="L153">        spinnerDuracion.setFont(new Font(&quot;Segoe UI&quot;, Font.PLAIN, 14));</span>
<span class="fc" id="L154">        spinnerDuracion.setPreferredSize(new Dimension(300, 40));</span>
<span class="fc" id="L155">        spinnerDuracion.setBorder(new LineBorder(new Color(189, 195, 199), 1, true));</span>
<span class="pc" id="L156">        spinnerDuracion.addChangeListener(e -&gt; actualizarCapacidad());</span>
<span class="fc" id="L157">        panel.add(spinnerDuracion, gbc);</span>
        
        // Tiempo de descanso
<span class="fc" id="L160">        gbc.gridx = 0; </span>
<span class="fc" id="L161">        gbc.gridy = 4;</span>
<span class="fc" id="L162">        panel.add(crearLabel(&quot;Tiempo de Descanso (minutos)&quot;), gbc);</span>
        
<span class="fc" id="L164">        gbc.gridx = 1;</span>
<span class="fc" id="L165">        spinnerDescanso = new JSpinner(new SpinnerNumberModel(5, 0, 30, 5));</span>
<span class="fc" id="L166">        spinnerDescanso.setFont(new Font(&quot;Segoe UI&quot;, Font.PLAIN, 14));</span>
<span class="fc" id="L167">        spinnerDescanso.setPreferredSize(new Dimension(300, 40));</span>
<span class="fc" id="L168">        spinnerDescanso.setBorder(new LineBorder(new Color(189, 195, 199), 1, true));</span>
<span class="pc" id="L169">        spinnerDescanso.addChangeListener(e -&gt; actualizarCapacidad());</span>
<span class="fc" id="L170">        panel.add(spinnerDescanso, gbc);</span>
        
        // Dia activo
<span class="fc" id="L173">        gbc.gridx = 0; </span>
<span class="fc" id="L174">        gbc.gridy = 5;</span>
<span class="fc" id="L175">        panel.add(crearLabel(&quot;Dia Activo&quot;), gbc);</span>
        
<span class="fc" id="L177">        gbc.gridx = 1;</span>
<span class="fc" id="L178">        checkActivo = new JCheckBox(&quot;Habilitar atencion en este dia&quot;);</span>
<span class="fc" id="L179">        checkActivo.setFont(new Font(&quot;Segoe UI&quot;, Font.PLAIN, 14));</span>
<span class="fc" id="L180">        checkActivo.setBackground(FONDO_BLANCO);</span>
<span class="fc" id="L181">        checkActivo.setSelected(true);</span>
<span class="fc" id="L182">        checkActivo.setFocusPainted(false);</span>
<span class="pc" id="L183">        checkActivo.addActionListener(e -&gt; actualizarCapacidad());</span>
<span class="fc" id="L184">        panel.add(checkActivo, gbc);</span>
        
        // Panel de capacidad calculada
<span class="fc" id="L187">        gbc.gridx = 0; </span>
<span class="fc" id="L188">        gbc.gridy = 6; </span>
<span class="fc" id="L189">        gbc.gridwidth = 2;</span>
<span class="fc" id="L190">        gbc.insets = new Insets(25, 15, 15, 15);</span>
<span class="fc" id="L191">        panel.add(crearPanelCapacidad(), gbc);</span>
        
        // Panel informativo
<span class="fc" id="L194">        gbc.gridx = 0; </span>
<span class="fc" id="L195">        gbc.gridy = 7; </span>
<span class="fc" id="L196">        gbc.gridwidth = 2;</span>
<span class="fc" id="L197">        gbc.insets = new Insets(15, 15, 15, 15);</span>
<span class="fc" id="L198">        panel.add(crearPanelInfo(), gbc);</span>
        
<span class="fc" id="L200">        return panel;</span>
    }
    
    private JPanel crearPanelCapacidad() {
<span class="fc" id="L204">        JPanel panel = new JPanel();</span>
<span class="fc" id="L205">        panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));</span>
<span class="fc" id="L206">        panel.setBackground(new Color(255, 243, 205));</span>
<span class="fc" id="L207">        panel.setBorder(BorderFactory.createCompoundBorder(</span>
            new LineBorder(new Color(241, 196, 15), 2, true),
            new EmptyBorder(20, 20, 20, 20)
        ));
        
<span class="fc" id="L212">        JLabel lblTitulo = new JLabel(&quot;Capacidad Estimada&quot;);</span>
<span class="fc" id="L213">        lblTitulo.setFont(new Font(&quot;Segoe UI&quot;, Font.BOLD, 15));</span>
<span class="fc" id="L214">        lblTitulo.setForeground(COLOR_PRIMARIO);</span>
<span class="fc" id="L215">        lblTitulo.setAlignmentX(Component.CENTER_ALIGNMENT);</span>
        
<span class="fc" id="L217">        lblCapacidad = new JLabel(&quot;0 citas por dia&quot;);</span>
<span class="fc" id="L218">        lblCapacidad.setFont(new Font(&quot;Segoe UI&quot;, Font.BOLD, 24));</span>
<span class="fc" id="L219">        lblCapacidad.setForeground(new Color(241, 196, 15));</span>
<span class="fc" id="L220">        lblCapacidad.setAlignmentX(Component.CENTER_ALIGNMENT);</span>
        
<span class="fc" id="L222">        panel.add(lblTitulo);</span>
<span class="fc" id="L223">        panel.add(Box.createVerticalStrut(10));</span>
<span class="fc" id="L224">        panel.add(lblCapacidad);</span>
        
<span class="fc" id="L226">        return panel;</span>
    }
    
    private JPanel crearPanelInfo() {
<span class="fc" id="L230">        JPanel panel = new JPanel();</span>
<span class="fc" id="L231">        panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));</span>
<span class="fc" id="L232">        panel.setBackground(new Color(174, 214, 241));</span>
<span class="fc" id="L233">        panel.setBorder(BorderFactory.createCompoundBorder(</span>
            new LineBorder(COLOR_SECUNDARIO, 2, true),
            new EmptyBorder(20, 20, 20, 20)
        ));
        
<span class="fc" id="L238">        JLabel lblInfo = new JLabel(&quot;Informacion&quot;);</span>
<span class="fc" id="L239">        lblInfo.setFont(new Font(&quot;Segoe UI&quot;, Font.BOLD, 15));</span>
<span class="fc" id="L240">        lblInfo.setForeground(COLOR_PRIMARIO);</span>
<span class="fc" id="L241">        lblInfo.setAlignmentX(Component.LEFT_ALIGNMENT);</span>
        
<span class="fc" id="L243">        String[] detalles = {</span>
            &quot;La duracion de cita incluye el tiempo de atencion al paciente&quot;,
            &quot;El tiempo de descanso se agrega entre cada cita&quot;,
            &quot;Los dias inactivos no generaran horarios disponibles&quot;,
            &quot;La capacidad se calcula automaticamente segun la configuracion&quot;
        };
        
<span class="fc" id="L250">        panel.add(lblInfo);</span>
<span class="fc" id="L251">        panel.add(Box.createVerticalStrut(12));</span>
        
<span class="fc bfc" id="L253" title="All 2 branches covered.">        for (String detalle : detalles) {</span>
<span class="fc" id="L254">            JLabel lblDetalle = new JLabel(&quot;• &quot; + detalle);</span>
<span class="fc" id="L255">            lblDetalle.setFont(new Font(&quot;Segoe UI&quot;, Font.PLAIN, 13));</span>
<span class="fc" id="L256">            lblDetalle.setForeground(new Color(52, 73, 94));</span>
<span class="fc" id="L257">            lblDetalle.setAlignmentX(Component.LEFT_ALIGNMENT);</span>
<span class="fc" id="L258">            panel.add(lblDetalle);</span>
<span class="fc" id="L259">            panel.add(Box.createVerticalStrut(5));</span>
        }
        
<span class="fc" id="L262">        return panel;</span>
    }
    
    private JLabel crearLabel(String texto) {
<span class="fc" id="L266">        JLabel label = new JLabel(texto);</span>
<span class="fc" id="L267">        label.setFont(new Font(&quot;Segoe UI&quot;, Font.BOLD, 15));</span>
<span class="fc" id="L268">        label.setForeground(COLOR_PRIMARIO);</span>
<span class="fc" id="L269">        return label;</span>
    }
    
    private JPanel crearPanelBotones() {
<span class="fc" id="L273">        JPanel panel = new JPanel(new FlowLayout(FlowLayout.CENTER, 15, 20));</span>
<span class="fc" id="L274">        panel.setBackground(FONDO_CLARO);</span>
<span class="fc" id="L275">        panel.setBorder(new EmptyBorder(10, 10, 10, 10));</span>
        
<span class="fc" id="L277">        btnVolver = crearBoton(&quot;Volver al Menu&quot;, COLOR_OSCURO);</span>
<span class="pc" id="L278">        btnVolver.addActionListener(e -&gt; dispose());</span>
        
<span class="fc" id="L280">        btnRestaurar = crearBoton(&quot;Restaurar Valores&quot;, new Color(149, 165, 166));</span>
<span class="fc" id="L281">        btnRestaurar.addActionListener(e -&gt; {</span>
<span class="nc" id="L282">            int confirmacion = JOptionPane.showConfirmDialog(</span>
                this,
                &quot;Esto restaurara todos los horarios a sus valores por defecto\nDesea continuar?&quot;,
                &quot;Confirmar Restauracion&quot;,
                JOptionPane.YES_NO_OPTION,
                JOptionPane.QUESTION_MESSAGE
            );
            
<span class="nc bnc" id="L290" title="All 2 branches missed.">            if (confirmacion == JOptionPane.YES_OPTION) {</span>
<span class="nc" id="L291">                controlador.restaurarHorariosDefault();</span>
            }
<span class="nc" id="L293">        });</span>
        
<span class="fc" id="L295">        btnCargar = crearBoton(&quot;Cargar Configuracion&quot;, COLOR_SECUNDARIO);</span>
<span class="pc" id="L296">        btnCargar.addActionListener(e -&gt; cargarConfiguracionActual());</span>
       
<span class="fc" id="L298">        btnGuardar = crearBoton(&quot;Guardar Configuracion&quot;, COLOR_ACENTO);</span>
<span class="pc" id="L299">        btnGuardar.addActionListener(e -&gt; guardarConfiguracion());</span>
        
<span class="fc" id="L301">        panel.add(btnVolver);</span>
<span class="fc" id="L302">        panel.add(btnRestaurar);</span>
<span class="fc" id="L303">        panel.add(btnCargar);</span>
<span class="fc" id="L304">        panel.add(btnGuardar);</span>
        
<span class="fc" id="L306">        return panel;</span>
    }
    
    private JButton crearBoton(String texto, Color color) {
<span class="fc" id="L310">        JButton btn = new JButton(texto);</span>
<span class="fc" id="L311">        btn.setFont(new Font(&quot;Segoe UI&quot;, Font.BOLD, 14));</span>
<span class="fc" id="L312">        btn.setBackground(color);</span>
<span class="fc" id="L313">        btn.setForeground(Color.WHITE);</span>
<span class="fc" id="L314">        btn.setFocusPainted(false);</span>
<span class="fc" id="L315">        btn.setBorderPainted(false);</span>
<span class="fc" id="L316">        btn.setPreferredSize(new Dimension(210, 48));</span>
<span class="fc" id="L317">        btn.setCursor(new Cursor(Cursor.HAND_CURSOR));</span>
        
<span class="fc" id="L319">        btn.addMouseListener(new java.awt.event.MouseAdapter() {</span>
            public void mouseEntered(java.awt.event.MouseEvent evt) {
<span class="nc" id="L321">                btn.setBackground(color.darker());</span>
<span class="nc" id="L322">            }</span>
            public void mouseExited(java.awt.event.MouseEvent evt) {
<span class="nc" id="L324">                btn.setBackground(color);</span>
<span class="nc" id="L325">            }</span>
        });
        
<span class="fc" id="L328">        return btn;</span>
    }
    
    private void cargarConfiguracionActual() {
<span class="nc" id="L332">        String diaSeleccionado = (String) comboDias.getSelectedItem();</span>
<span class="nc bnc" id="L333" title="All 2 branches missed.">        if (controlador != null) {</span>
<span class="nc" id="L334">            controlador.cargarConfiguracion(diaSeleccionado);</span>
        }
<span class="nc" id="L336">    }</span>
    
    private void guardarConfiguracion() {
<span class="nc" id="L339">        String dia = (String) comboDias.getSelectedItem();</span>
        
<span class="nc" id="L341">        java.util.Date dateInicio = (java.util.Date) spinnerHoraInicio.getValue();</span>
<span class="nc" id="L342">        java.util.Date dateFin = (java.util.Date) spinnerHoraFin.getValue();</span>
        
<span class="nc" id="L344">        LocalTime inicio = LocalTime.of(dateInicio.getHours(), dateInicio.getMinutes());</span>
<span class="nc" id="L345">        LocalTime fin = LocalTime.of(dateFin.getHours(), dateFin.getMinutes());</span>
        
<span class="nc bnc" id="L347" title="All 4 branches missed.">        if (fin.isBefore(inicio) || fin.equals(inicio)) {</span>
<span class="nc" id="L348">            mostrarError(&quot;La hora de fin debe ser posterior a la hora de inicio&quot;);</span>
<span class="nc" id="L349">            return;</span>
        }
        
<span class="nc" id="L352">        int duracion = (Integer) spinnerDuracion.getValue();</span>
<span class="nc" id="L353">        int descanso = (Integer) spinnerDescanso.getValue();</span>
<span class="nc" id="L354">        boolean activo = checkActivo.isSelected();</span>
        
<span class="nc bnc" id="L356" title="All 2 branches missed.">        if (controlador != null) {</span>
<span class="nc" id="L357">            controlador.guardarConfiguracion(dia, inicio, fin, duracion, descanso, activo);</span>
        }
<span class="nc" id="L359">    }</span>
    
    private void actualizarCapacidad() {
        try {
<span class="fc" id="L363">            java.util.Date dateInicio = (java.util.Date) spinnerHoraInicio.getValue();</span>
<span class="fc" id="L364">            java.util.Date dateFin = (java.util.Date) spinnerHoraFin.getValue();</span>
            
<span class="fc" id="L366">            int minutosDisponibles = (dateFin.getHours() * 60 + dateFin.getMinutes()) -</span>
<span class="fc" id="L367">                                   (dateInicio.getHours() * 60 + dateInicio.getMinutes());</span>
            
<span class="fc" id="L369">            int duracion = (Integer) spinnerDuracion.getValue();</span>
<span class="fc" id="L370">            int descanso = (Integer) spinnerDescanso.getValue();</span>
<span class="fc" id="L371">            int minutosPorCita = duracion + descanso;</span>
            
<span class="pc bpc" id="L373" title="2 of 4 branches missed.">            int capacidad = checkActivo.isSelected() &amp;&amp; minutosPorCita &gt; 0 </span>
<span class="fc" id="L374">                ? minutosDisponibles / minutosPorCita </span>
<span class="pc" id="L375">                : 0;</span>
                
<span class="fc" id="L377">            lblCapacidad.setText(capacidad + &quot; citas por dia&quot;);</span>
<span class="nc" id="L378">        } catch (Exception e) {</span>
<span class="nc" id="L379">            lblCapacidad.setText(&quot;-- citas por dia&quot;);</span>
<span class="fc" id="L380">        }</span>
<span class="fc" id="L381">    }</span>
    
    // ================== METODOS PUBLICOS PARA EL CONTROLADOR ==================
    
    public void setControlador(ControladorHorarios controlador) {
<span class="fc" id="L386">        this.controlador = controlador;</span>
<span class="fc" id="L387">    }</span>
    
    public void cargarDatos(ConfiguracionHorario config) {
<span class="fc" id="L390">        java.util.Calendar cal = java.util.Calendar.getInstance();</span>
        
<span class="fc" id="L392">        cal.set(java.util.Calendar.HOUR_OF_DAY, config.getHoraInicio().getHour());</span>
<span class="fc" id="L393">        cal.set(java.util.Calendar.MINUTE, config.getHoraInicio().getMinute());</span>
<span class="fc" id="L394">        spinnerHoraInicio.setValue(cal.getTime());</span>
        
<span class="fc" id="L396">        cal.set(java.util.Calendar.HOUR_OF_DAY, config.getHoraFin().getHour());</span>
<span class="fc" id="L397">        cal.set(java.util.Calendar.MINUTE, config.getHoraFin().getMinute());</span>
<span class="fc" id="L398">        spinnerHoraFin.setValue(cal.getTime());</span>
        
<span class="fc" id="L400">        spinnerDuracion.setValue(config.getDuracionCita());</span>
<span class="fc" id="L401">        spinnerDescanso.setValue(config.getTiempoDescanso());</span>
<span class="fc" id="L402">        checkActivo.setSelected(config.isActivo());</span>
        
<span class="fc" id="L404">        actualizarCapacidad();</span>
<span class="fc" id="L405">    }</span>
    
    public void mostrarExito(String mensaje) {
<span class="nc" id="L408">        JOptionPane.showMessageDialog(this, mensaje, &quot;Operacion Exitosa&quot;, </span>
            JOptionPane.INFORMATION_MESSAGE);
<span class="nc" id="L410">    }</span>
    
    public void mostrarError(String mensaje) {
<span class="nc" id="L413">        JOptionPane.showMessageDialog(this, mensaje, &quot;Error&quot;, </span>
            JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L415">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>